---
title: "Проблемы и отладка"
og:description: "Советы по диагностике неполадок при использовании Софтфона, типовые ошибки и их расшифровка."
---

## Общие замечания

Для корректной работы Софтфона в Telegram необходимо:

- Иметь активную подписку **Софтфон** в боте [@siptg_bot](https://t.me/siptg_bot?start=utm_docs).
- Убедиться, что в настройках конфиденциальности Telegram разрешены голосовые звонки от «Всех» или как минимум от @siptg.
- Правильно указать в боте адрес SIP-сервера (с нужным портом, если он нестандартный), логин и пароль.
- При необходимости настроить аудиокодеки и «Правила набора» (Rewrite-rules) так, чтобы они соответствовали требованиям вашей АТС или SIP-провайдера.

Ниже приведён расширённый список проблем, которые возникали хотя бы раз за всю историю обращений пользователей.

<AccordionGroup>
  <Accordion title="Зависание приложения Telegram на проблемном устройстве">
    **Симптомы**

    - На одном из устройств приложение Telegram «зависает» в состоянии активного звонка, хотя никаких признаков активного звонка нет.
    - Вследствие этого все входящие звонки автоматически отклоняются на всех устройствах, привязанных к аккаунту Telegram.

    **Возможные причины**

    - Проблема на конкретном устройстве (сбой клиента Telegram), которое оказалось в некорректном состоянии звонка.
    - Проблемы с сетью или задержки при обмене служебными сообщениями, приводящие к постоянному статусу «активного звонка».

    **Решение**

    1. Идентифицируйте проблемное устройство: каждое из ваших устройств по очереди необходимо отключать от интернета до тех пор, пока входящие звонки перестанут сбрасываться. После этого проблемное устройство нужно перезагрузить или на нём полностью выгрузить из памяти приложение Telegram.
    2. Рекомендуется обновить приложение Telegram до последней версии и выполнить полное закрытие приложения.
    3. В случае повторения проблемы, соберите логи с проблемного устройства для дальнейшего анализа и устранения неисправности.
  </Accordion>
  <Accordion title="Звонок сбрасывается через несколько секунд или нет звука">
    **Симптомы**

    - При исходящем или входящем вызове абонента не слышат, либо звук резко пропадает.
    - Звонок сбрасывается в течение 5–10 секунд.

    **Возможные причины**

    - Неподходящий или конфликтующий аудиокодек.
    - Провайдер или АТС не принимает текущий набор кодеков, либо Telegram не успевает согласовать параметры аудиопотока.
    - Неправильная настройка RTP или ошибки в передаче голосовых пакетов.

    **Решение**

    1. В боте [@siptg_bot](https://t.me/siptg_bot?start=utm_docs) в разделе `/softphone`  _→ Настройка SIP-аккаунта → Аудиокодеки_ установите краткий список, например:

       ```
       opus,alaw,mulaw
       ```

       При необходимости укажите конкретный аудиокодек (например, только `alaw` или `mulaw`).
    2. Проверьте настройки Worker-сервера и брандмауэра.
  </Accordion>
  <Accordion title="Ошибка «No lines for call» или «Отсутствуют линии для звонка»">
    **Симптомы**

    - При попытке совершить исходящий вызов бот сообщает, что отсутствуют доступные линии.
    - Возможно, в логах появляется ошибка с кодом, указывающая на недоступность линии.

    **Возможные причины**

    - Неверно настроенные «Правила набора» (Rewrite-rules), которые исключают корректные номера.
    - Превышено количество активных SIP-аккаунтов, разрешённых подпиской.
    - Ошибки в параметрах SIP-аккаунта (неверный логин, сервер или пароль).

    **Решение**

    1. Проверьте и при необходимости сбросьте правила набора, введя значение `=` в настройках SIP-аккаунта.
    2. Убедитесь, что общее число SIP-аккаунтов соответствует оплаченной подписке.
    3. Попробуйте перезапустить SIP-аккаунт через команду `/softphone` в боте [@siptg_bot](https://t.me/siptg_bot?start=utm_docs).
  </Accordion>
  <Accordion title="Нельзя принять входящий звонок (сбрасывается или не поступает)">
    **Симптомы**

    - В Telegram входящий вызов не появляется или сразу отклоняется.
    - При попытке ответа происходит «обмен ключами», после которого звонок завершается.

    **Возможные причины**

    - В настройках конфиденциальности Telegram вызовы от бота могут быть заблокированы.
    - SIP-регистрация не проходит должным образом или настройки Worker-сервера некорректны.
    - Ошибки в приоритете аудиокодеков приводят к неверной установке голосового канала.

    **Решение**

    1. Проверьте настройки в Telegram: убедитесь, что в разделе «Конфиденциальность и безопасность → Голосовые звонки» выбрана опция «Все».
    2. В разделе `/softphone` проверьте статус аккаунта и, при необходимости, активируйте его повторно.
    3. Убедитесь, что SIP-регистрация проходит успешно и что IP-адреса Worker-сервера добавлены в «белый список» на стороне АТС.
  </Accordion>
  <Accordion title="Ошибка «Amount of fail calls is exceeded» или «SIP account has disallowed settings»">
    **Симптомы**

    - Бот сообщает, что превышены лимиты неуспешных звонков или что текущий SIP-аккаунт не разрешён тарифом.
    - Звонки не проходят из-за превышения установленных лимитов.

    **Возможные причины**

    - Пользователь самостоятельно активировал SIP-аккаунт без привязки к администрируемой подписке.
    - Превышены внутренние ограничения тарифного плана (например, по числу неуспешных попыток).
    - Неправильно распределены или активированы SIP-аккаунты.

    **Решение**

    1. Проверьте, что SIP-аккаунт включён и привязан в разделе `/softphone` бота.
    2. Сверьте число активных аккаунтов с данными в разделе `/subscriptions`.
    3. Если аккаунт активирован самостоятельно, свяжитесь с поддержкой для его перенастройки под администрирование.
  </Accordion>
  <Accordion title="Telegram зависает в статусе активного звонка">
    **Симптомы**

    - После завершения вызова Telegram продолжает отображать активный статус звонка.
    - Новые входящие вызовы не принимаются, а активный вызов мешает совершать последующие звонки.

    **Возможные причины**

    - Задержка в передаче уведомления о завершении вызова через сеть Telegram.
    - Проблема в клиентском приложении Telegram (особенно на Android), когда приложение не обновляет статус вызова.

    **Решение**

    1. Обновите Telegram до последней версии.
    2. Полностью закройте приложение и запустите его снова или перезагрузите устройство.
    3. Если проблема возникает регулярно, соберите логи и обратитесь в публичную группу за поддержкой.
  </Accordion>
  <Accordion title="Проблемы с «Правилами набора» (Rewrite-rules)">
    **Симптомы**

    - Любой исходящий номер не проходит – звонок сразу блокируется с ошибкой (например, 404).
    - При наборе номера появляется сообщение, что номер не соответствует правилам.

    **Возможные причины**

    - Неверно настроенные регулярные выражения, блокирующие корректные номера.
    - Ручное изменение поля «Правила набора» привело к исключению всех номеров.

    **Решение**

    1. Сбросьте настройки правил набора, введя значение `=` в соответствующем поле.
    2. При необходимости используйте корректные RegExp-правила для преобразования номеров, проверив их тестированием.
    3. Проверьте логи АТС на наличие сообщений о неподдерживаемых номерах.
  </Accordion>
  <Accordion title="Callback и вызовы через отправку номера в чат">
    **Симптомы**

    - При отправке номера в чат с ботом появляется сообщение «Сделайте исходящий звонок», но звонок не доходит, если пользователь не отвечает вовремя.
    - Исходящий набор «зависает» в ожидании обратного вызова.

    **Возможные причины**

    - Включён режим Callback, и пользователь не успевает ответить на обратный вызов бота.
    - В настройках Telegram для бота запрещены входящие вызовы.

    **Решение**

    1. Если Callback не требуется, отключите его в разделе `/softphone`.
    2. Если функция нужна, удостоверьтесь, что настройки Telegram позволяют принимать вызовы от аккаунта @siptg.
  </Accordion>
  <Accordion title="Другие редкие проблемы и рекомендации">
    - **Ограничения Telegram при массовых вызовах:**\
      При большом количестве исходящих звонков система может выдавать ошибки `503 Too Many Requests` или `408 Timeout of waiting RPC result`. Решение – снизьте скорость обзвона.
    - **Проблемы с DTMF:**\
      Если при взаимодействии с голосовым меню (IVR) не распознаются нажатия, измените метод передачи DTMF в настройках (например, переключитесь с `inband` на `RFC2833` или `INFO`).
    - **Проблемы с регистрацией на Worker-сервере:**\
      Иногда SIP-регистрация не происходит из-за того, что Worker-сервер не отвечает или IP-адрес не внесён в «белый список». Решение – проверьте настройки сети и добавьте необходимые IP в белый список.
    - **Конфликты при самостоятельном обновлении настроек:**\
      Если пользователи самостоятельно изменяют параметры SIP-аккаунта (например, аудиокодеки, rewrite-rules), это может привести к ошибкам при массовом управлении. Рекомендуется централизованное администрирование через общий «админский» аккаунт.
  </Accordion>
</AccordionGroup>

<Info>
  Если описанные действия не помогли, обратитесь за бесплатной консультацией в публичную группу Telegram [@siptg_public](https://t.me/siptg_public).\
  Если ваши траты на услуги SIP․TG превышают **150 EUR в месяц**, мы оказываем прямую поддержку — пишите в [@siptg_support](https://t.me/siptg_support?start=utm_docs).
</Info>